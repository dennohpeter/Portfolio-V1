
<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js ">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>
First steps with Gulp.js | Front End Developer | JavaScript | Angular 2+
</title>
<link rel="canonical" href="https://jacekjeznach.com/first-steps-with-gulp-js/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="First steps with Gulp.js | Front End Developer | JavaScript | Angular 2+" />
<meta property="og:description" content="Front end front end developers spend little time coding. Even if we ignore meetings, much of the job involves basic tasks your working day: Tasks must be repeated every time you make a change. You begin with good intentions but the infallible front end developer will forget to compress an image or two. Over time, &hellip;" />
<meta property="og:url" content="https://jacekjeznach.com/first-steps-with-gulp-js/" />
<meta property="og:site_name" content="Front End Developer | JavaScript | Angular 2+" />
<meta property="article:publisher" content="https://www.facebook.com/pages/JJ-Web-Developer/1065969103428564" />
<meta property="article:tag" content="task runner" />
<meta property="article:section" content="Tools" />
<meta property="article:published_time" content="2017-01-22T13:26:16+00:00" />
<meta property="article:modified_time" content="2017-01-22T14:04:55+00:00" />
<meta property="og:updated_time" content="2017-01-22T14:04:55+00:00" />
<meta property="og:image" content="wp-content/uploads/2017/01/gulp-bg.png" />
<meta property="og:image:width" content="1600" />
<meta property="og:image:height" content="800" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Front end front end developers spend little time coding. Even if we ignore meetings, much of the job involves basic tasks your working day: Tasks must be repeated every time you make a change. You begin with good intentions but the infallible front end developer will forget to compress an image or two. Over time, [&hellip;]" />
<meta name="twitter:title" content="First steps with Gulp.js | Front End Developer | JavaScript | Angular 2+" />
<meta name="twitter:site" content="@JeznachJacek" />
<meta name="twitter:image" content="wp-content/uploads/2017/01/gulp-bg.png" />
<meta name="twitter:creator" content="@JeznachJacek" />
  <script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"https:\/\/jacekjeznach.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5600043c36802d51cde71399f3d25aeb"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;return g&&g.fillText?(g.textBaseline="top",g.font="600 32px Arial","flag"===a?(g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>
3e3):"diversity"===a?(g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e):("simple"===a?g.fillText(h(55357,56835),0,0):g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag"),unicode8:d("unicode8"),diversity:d("diversity")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag&&c.supports.unicode8&&c.supports.diversity||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
</script>
 <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='wp-pagenavi-css'  href='wp-content/plugins/wp-pagenavi/pagenavi-css.css?ver=2.70' media='all' />
<link rel='stylesheet' id='jayjay-css'  href='wp-content/themes/jj/style.css?ver=1.0' media='all' />
<link rel='https://api.w.org/' href='wp-json/' />
<link rel="alternate" type="application/json+oembed" href="wp-json/oembed/1.0/embed?url=https%3A%2F%2Fjacekjeznach.com%2Ffirst-steps-with-gulp-js%2F" />
<link rel="alternate" type="text/xml+oembed" href="wp-json/oembed/1.0/embed?url=https%3A%2F%2Fjacekjeznach.com%2Ffirst-steps-with-gulp-js%2F&#038;format=xml" />
<link rel="apple-touch-icon" sizes="57x57" href="wp-content/themes/jj/fav/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="wp-content/themes/jj/fav/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="wp-content/themes/jj/fav/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="wp-content/themes/jj/fav/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="wp-content/themes/jj/fav/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="wp-content/themes/jj/fav/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="wp-content/themes/jj/fav/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="wp-content/themes/jj/fav/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="wp-content/themes/jj/fav/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="wp-content/themes/jj/fav/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="wp-content/themes/jj/fav/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="wp-content/themes/jj/fav/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="wp-content/themes/jj/fav/favicon-16x16.png">
<link href='http://fonts.googleapis.com/css?family=La+Belle+Aurore' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Archivo+Narrow:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<link rel="stylesheet" href="wp-content/themes/jj/css/third-party.css">
<link rel="stylesheet" href="wp-content/themes/jj/css/normalize.css">
<link rel="stylesheet" href="wp-content/themes/jj/css/main.css">
 <script src="wp-content/themes/jj/js/vendor/modernizr-2.8.3.min.js">

</script>
 <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true">

</script>
 <script>
var path = "wp-content/themes/jj/";
</script>

</head>
<body class="jj-wall">
<div id="awwwards" class="nominee black right">
 <a href="http://www.awwwards.com/best-websites/jj-web-developer-wordpress-developer/" target="_blank">
Awwwards
</a>

</div>
<div class="wall-top">
<div class="width-holder">
 <a href="/wall">
<img src="wp-content/themes/jj/img/wall-logo.png" alt="Web Developer Wall, Wordpress Developer wall"/>

</a>
 <small>
Front End Developer / Web Developer / WordPress
</small>

</div>

</div>
<div class="width-holder">
<div class="wall-cont">
 <a href="/" class="logo-big">
<img src="wp-content/themes/jj/img/wall-logo.png" alt="Web Developer Wall, Wordpress Developer wall"/>

</a>
<h1>
WALL
</h1>
<div class="left-col">
<div class="posts">
<div id="blog_loop">
<div class="post-article single">
<div class="post-content">
<div class="blog-post-title">
<h5>
 <a>
First steps with Gulp.js
</a>

</h5>

</div>
<div class="post-date">
<h2>
Jan 2017
</h2>

</div>
<div class="post-image">
 <a target="_blank" >
<img src="wp-content/uploads/2017/01/gulp-bg-700x350.png" class="attachment-large size-large wp-post-image" alt="gulp-bg" srcset="wp-content/uploads/2017/01/gulp-bg-250x125.png 250w, wp-content/uploads/2017/01/gulp-bg-768x384.png 768w, wp-content/uploads/2017/01/gulp-bg-700x350.png 700w, wp-content/uploads/2017/01/gulp-bg-120x60.png 120w, wp-content/uploads/2017/01/gulp-bg.png 1600w" sizes="(max-width: 700px) 100vw, 700px" />

</a>

</div>
<div class="blog-post-content text-div">
<p class="wp-special">
Front end front end developers spend little time coding. Even if we ignore meetings, much of the job involves basic tasks your working day:
</p>
<div class="ArticleBox u-inline">
Tasks must be repeated every time you make a change. You begin with good intentions but the infallible front end developer will forget to compress an image or two. Over time, tasks become increasingly arduous and time-consuming; you’ll dread the inevitable content and template changes. It’s mind-numbing, repetitive work. Would it be better to spend your time on more profitable jobs?
</div>
<p>
If so, you need a <em>
task runner.
</em>

</p>
<h2 id="thatsoundsscarilycomplicated">
That Sounds Complicated!
</h2>
<p>
Creating a build process will take time. It’s more complex than performing each task manually but, in long-term, you will save hours of effort, reduce human error and save your sanity. Adopt a pragmatic approach:
</p>
<ul>
<li>
automate the most irritating tasks first
</li>
<li>
try not to over-complicate your build process; an hour or two is more than enough for the initial set-up
</li>
<li>
choose task runner software and stick with it for a while.
</li>

</ul>
<p>
Part of the tools may be new to you but take a deep breath and concentrate on one thing at a time.
</p>
<h2 id="taskrunnerstheoptions">
Task Runners: Gulp
</h2>
<p>
Many issues were addressed in later editions but <a href="http://gulpjs.com/">
Gulp
</a>
 had already arrived and offered a number of improvements:
</p>
<ol>
<li>
Features such as file watching were built-in.
</li>
<li>
Gulp plug-ins were <em>
(mostly)
</em>
 designed to do a single job.
</li>
<li>
Gulp used JavaScript configuration code which was less verbose, easier to read, simpler to modify, and provided better flexibility.
</li>
<li>
Gulp was faster because it uses <a href="https://www.sitepoint.com/basics-node-js-streams/">
Node.js streams
</a>
 to pass data through a series of piped plug-ins. Files were only written at the end of the task.
</li>

</ol>
<p>
Of course, Gulp itself isn’t perfect and new task runners such as <a href="http://broccolijs.com/">
Broccoli.js
</a>
, <a href="http://brunch.io/">
Brunch
</a>
 and <a href="https://webpack.github.io/">
webpack
</a>
 have also been competing for front end developer attention. More recently, <a href="https://www.sitepoint.com/guide-to-npm-as-a-build-tool/">
npm itself has been touted as a simpler option
</a>
. All have their pros and cons, but <a href="https://ashleynolan.co.uk/blog/frontend-tooling-survey-2016-results#js-task-runners">
Gulp remains the favorite and is currently used by more than 40% of web developers
</a>
.
</p>
<p>
Gulp needs Node.js but, while Part JavaScript knowledge is beneficial, front end developers from all web programming faiths will find it useful.
</p>
<p>
This guidedescribes how to use Gulp 3 – the most recent release version at the time of writing. Gulp 4 has been in development for Part time but remains a beta product. It’s possible to <a href="https://www.joezimjs.com/javascript/complete-guide-upgrading-gulp-4/">
use or switch to Gulp 4
</a>
 but I recommend sticking with version 3 until the final release.
</p>
<h2 id="step1installnodejs">
Step 1: Node.js
</h2>
<p>
Node.js can be downloaded for Windows, Mac and Linux from <a href="https://nodejs.org/download/">
nodejs.org/download/
</a>
. There are different options for installing from binaries, package managers and docker images – full instructions are available.
</p>
<p>
<strong>
Note for Windows users:
</strong>
 Node.js and Gulp run on Windows but some plug-ins may not install or run if they depend on native Linux binaries such as image compression libraries. One option for Windows 10 users is the new <a href="https://msdn.microsoft.com/en-us/commandline/wsl/install_guide">
bash command-line
</a>
; this solves many issues but is a beta product and could introduce alternative problems.
</p>
<p>
Once installed, open a command prompt and enter:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
node -v

</code>

</pre>
<p>
to reveal the version number. You’re about to make heavy use of <code class=" language-undefined">
npm
</code>
 – the Node.js package manager which is used to install modules. Examine its version number:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm -v

</code>

</pre>
<p>
<strong>
Note for Linux users:
</strong>
 Node.js modules can be installed globally so they are available throughout your system. However, most users will not have permission to write to the global directories unless <code class=" language-undefined">
npm
</code>
 commands are prefixed with <code class=" language-undefined">
sudo
</code>
. There are a number of <a href="https://docs.npmjs.com/getting-started/fixing-npm-permissions">
options to fix npm permissions
</a>
 and tools such as <a href="https://www.sitepoint.com/quick-tip-multiple-versions-node-nvm/">
nvm can help
</a>
 but I often change the default directory, e.g. on Ubuntu/Debian-based platforms:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
<span class="token function">
cd
</span>
 ~
<span class="token function">
mkdir
</span>
 .node_modules_global
npm config <span class="token keyword">
set
</span>
 prefix<span class="token operator">
=
</span>
<span class="token variable">
$HOME
</span>
/.node_modules_global
npm <span class="token function">
install
</span>
 npm -g

</code>

</pre>
<p>
Then add the following line to the end of <code class=" language-undefined">
~/.bashrc
</code>
:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
<span class="token function">
export
</span>
 PATH<span class="token operator">
=
</span>
<span class="token string">
"<span class="token variable">
$HOME
</span>
/.node_modules_global/bin:<span class="token variable">
$PATH
</span>
"
</span>


</code>

</pre>
<p>
and update with:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
<span class="token function">
source
</span>
 ~/.bashrc

</code>

</pre>
<h2 id="step2installgulpglobally">
Step 2: Install Gulp Globally
</h2>
<p>
Install Gulp command-line interface globally so the <code class=" language-undefined">
gulp
</code>
 command can be run from any project folder:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp-cli -g

</code>

</pre>
<p>
Verify Gulp has installed with:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
gulp -v

</code>

</pre>
<h2 id="step3configureyourproject">
Step 3: Configure Your Bulid
</h2>
<p>
<strong>
Note for Node.js projects:
</strong>
 you can skip this step if you already have a <code class=" language-undefined">
package.json
</code>
 configuration file.
</p>
<p>
Presume you have a new or pre-existing project in the folder <code class=" language-undefined">
project1
</code>
. Navigate to this folder and initialize it with npm:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
<span class="token function">
cd
</span>
 project1
npm init

</code>

</pre>
<p>
You will be asked a series of questions – enter a value or hit <strong>
Return
</strong>
 to accept defaults. A <code class=" language-undefined">
package.json
</code>
 file will be created on completion which stores your <code class=" language-undefined">
npm
</code>
 configuration settings.
</p>
<p>
For the remainder of this article we’ll presume your project folder contains the following sub-folders:
</p>
<h3 id="srcfolderpreprocessedsourcefiles">
<code class=" language-undefined">
src
</code>
 folder: pre-processed source files
</h3>
<p>
This contains further sub-folders:
</p>
<ul>
<li>
<code class=" language-undefined">
html
</code>
 – HTML source files
</li>
<li>
<code class=" language-undefined">
images
</code>
 — the original uncompressed images
</li>
<li>
<code class=" language-undefined">
js
</code>
 — multiple pre-processed script files
</li>
<li>
<code class=" language-undefined">
scss
</code>
 — multiple pre-processed Sass <code class=" language-undefined">
.scss
</code>
 files
</li>

</ul>
<h3 id="buildfoldercompiledprocessedfiles">
<code class=" language-undefined">
build
</code>
 folder: compiled/processed files
</h3>
<p>
Gulp will create files and create sub-folders as necessary:
</p>
<ul>
<li>
<code class=" language-undefined">
html
</code>
 – compiled static HTML files
</li>
<li>
<code class=" language-undefined">
images
</code>
 — compressed images
</li>
<li>
<code class=" language-undefined">
js
</code>
 — a single concatenated and minified JavaScript file
</li>
<li>
<code class=" language-undefined">
css
</code>
 — a single compiled and minified CSS file
</li>

</ul>
<p>
Your project will almost certainly be different but this structure is used for the examples below.
</p>
<p>
Tip: If you’re on a Unix-based system and you just want to follow along with the tutorial, you can recreate the folder structure with the following command:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
<span class="token function">
mkdir
</span>
 -p src/<span class="token punctuation">
{
</span>
html,images,js,scss<span class="token punctuation">
}
</span>
 build/<span class="token punctuation">
{
</span>
html,images,js,css<span class="token punctuation">
}
</span>


</code>

</pre>
<h2 id="step4installgulplocally">
Step 3a: Install Gulp
</h2>
<p>
You can now install Gulp in your project folder using the command:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp --save-dev

</code>

</pre>
<p>
This installs Gulp as a development dependency and the <code class=" language-undefined">
"devDependencies"
</code>
 section of <code class=" language-undefined">
package.json
</code>
 is updated accordingly.
</p>
<h3 id="alternativedeploymentoptions">

</h3>
<h2 id="step4createagulpconfigurationfile">
Step 4: Create a Gulpfile.js
</h2>
<p>
Create a new <code class=" language-undefined">
gulpfile.js
</code>
 configuration file in the root of your project folder. Add some basic code to get begined:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// Gulp.js configuration
</span>

<span class="token keyword">
var
</span>

  <span class="token comment" spellcheck="true">
// modules
</span>

  gulp <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


  <span class="token comment" spellcheck="true">
// development mode?
</span>

  devBuild <span class="token operator">
=
</span>
 <span class="token punctuation">
(
</span>
process<span class="token punctuation">
.
</span>
env<span class="token punctuation">
.
</span>
NODE_ENV <span class="token operator">
!==
</span>
 <span class="token string">
'production'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


  <span class="token comment" spellcheck="true">
// folders
</span>

  folder <span class="token operator">
=
</span>
 <span class="token punctuation">
{
</span>

    src<span class="token punctuation">
:
</span>
 <span class="token string">
'src/'
</span>
<span class="token punctuation">
,
</span>

    build<span class="token punctuation">
:
</span>
 <span class="token string">
'build/'
</span>

  <span class="token punctuation">
}
</span>

<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
This references the Gulp module, sets a <code class=" language-undefined">
devBuild
</code>
 variable to <code class=" language-undefined">
true
</code>
 when running in development (or non-production mode) and defines the source and build folder locations.
</p>
<p>
&nbsp;
</p>
<h2 id="step5creategulptasks">
Step 5: Create new Gulp Tasks
</h2>
<p>
On it’s own, Gulp does nothing. You must:
</p>
<ol>
<li>
install Gulp plug-ins, and
</li>
<li>
write tasks which utilize those plug-ins to do something useful.
</li>

</ol>
<p>
It’s possible to write your own plug-ins but, since almost 3,000 are available, it’s unlikely you’ll ever need to. You can search using Gulp’s own directory at <a href="http://gulpjs.com/plugins/">
gulpjs.com/plugins/
</a>
, on <a href="https://www.npmjs.com/">
npmjs.com
</a>
, or search “gulp <em>
something
</em>
” to harness the mighty power of Google.
</p>
<p>
Gulp provides three primary task methods:
</p>
<ul>
<li>
<code class=" language-undefined">
gulp.task
</code>
 – defines a new task with a name, optional array of dependencies and a function.
</li>
<li>
<code class=" language-undefined">
gulp.src
</code>
 – sets the folder where source files are located.
</li>
<li>
<code class=" language-undefined">
gulp.dest
</code>
 – sets the destination folder where build files will be placed.
</li>

</ul>
<p>
Any number of plug-in calls are set with <code class=" language-undefined">
pipe
</code>
 between the <code class=" language-undefined">
.src
</code>
 and <code class=" language-undefined">
.dest
</code>
.
</p>
<h3 id="imagetask">
Image Task
</h3>
<p>
This is best demonstrated with an example so let’s create a basic task which compresses images and copies them to the appropriate <code class=" language-undefined">
build
</code>
 folder. Since this process could take time, we’ll only compress new and modified files. Two plug-ins can help us: <a href="https://www.npmjs.com/package/gulp-newer">
gulp-newer
</a>
 and <a href="https://www.npmjs.com/package/gulp-imagemin">
gulp-imagemin
</a>
. Install them from the command-line:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp-newer gulp-imagemin --save-dev

</code>

</pre>
<p>
We can now reference both modules the top of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// Gulp.js configuration
</span>


<span class="token keyword">
var
</span>

  <span class="token comment" spellcheck="true">
// modules
</span>

  gulp <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  newer <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-newer'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  imagemin <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-imagemin'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


</code>

</pre>
<p>
We can now define the image processing task itself as a function at the end of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// image processing
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'images'
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

  <span class="token keyword">
var
</span>
 out <span class="token operator">
=
</span>
 folder<span class="token punctuation">
.
</span>
build <span class="token operator">
+
</span>
 <span class="token string">
'images/'
</span>
<span class="token punctuation">
;
</span>

  <span class="token keyword">
return
</span>
 gulp<span class="token punctuation">
.
</span>
<span class="token function">
src
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'images/**/*'
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
newer
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
imagemin
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
{
</span>
 optimizationLevel<span class="token punctuation">
:
</span>
 <span class="token number">
5
</span>
 <span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
gulp<span class="token punctuation">
.
</span>
<span class="token function">
dest
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>

<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
All tasks are syntactically similar. This code:
</p>
<ol>
<li>
Creates a new task named <code class=" language-undefined">
images
</code>
.
</li>
<li>
Defines a function with a return value which…
</li>
<li>
Defines an <code class=" language-undefined">
out
</code>
 folder where build files will be located.
</li>
<li>
Sets the Gulp <code class=" language-undefined">
src
</code>
 source folder. The <code class=" language-undefined">
/**/*
</code>
 ensures that images in sub-folders are also processed.
</li>
<li>
Pipes all files to the <code class=" language-undefined">
gulp-newer
</code>
 module. Source files that are newer than corresponding destination files are passed through. Everything else is removed.
</li>
<li>
The remaining new or changed files are piped through <code class=" language-undefined">
gulp-imagemin
</code>
 which sets an optional <code class=" language-undefined">
optimizationLevel
</code>
argument.
</li>
<li>
The compressed images are output to the Gulp <code class=" language-undefined">
dest
</code>
 folder set by <code class=" language-undefined">
out
</code>
.
</li>

</ol>
<p>
Save <code class=" language-undefined">
gulpfile.js
</code>
 and place a few images in your project’s <code class=" language-undefined">
src/images
</code>
 folder before running the task from the command line:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
gulp images

</code>

</pre>
<p>
All images are compressed accordingly and you will see output such as:
</p>
<pre class=" language-undefined">
<code class=" language-undefined">
Using file gulpfile.js
Running 'imagemin'...
Finished 'imagemin' in 5.71 ms
gulp-imagemin: image1.png (saved 48.7 kB)
gulp-imagemin: image2.jpg (saved 36.2 kB)
gulp-imagemin: image3.svg (saved 12.8 kB)

</code>

</pre>
<p>
Try running <code class=" language-undefined">
gulpimages
</code>
 again and nothing should happen because no newer images exist.
</p>
<h3 id="htmltask">
HTML Task
</h3>
<p>
We can now create a similar task which copies files from the source HTML folder. We can safely minify our HTML code to remove unnecessary whitespace and attributes using the <a href="https://www.npmjs.com/package/gulp-htmlclean">
gulp-htmlclean
</a>
 plug-in:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp-htmlclean --save-dev

</code>

</pre>
<p>
which is then referenced at the top of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token keyword">
var
</span>

  <span class="token comment" spellcheck="true">
// modules
</span>

  gulp <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  newer <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-newer'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  imagemin <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-imagemin'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  htmlclean <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-htmlclean'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


</code>

</pre>
<p>
We can now create an <code class=" language-undefined">
html
</code>
 task at the end of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// HTML processing
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'html'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'images'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

  <span class="token keyword">
var
</span>

    out <span class="token operator">
=
</span>
 folder<span class="token punctuation">
.
</span>
build <span class="token operator">
+
</span>
 <span class="token string">
'html/'
</span>
<span class="token punctuation">
,
</span>

    page <span class="token operator">
=
</span>
 gulp<span class="token punctuation">
.
</span>
<span class="token function">
src
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'html/**/*'
</span>
<span class="token punctuation">
)
</span>

      <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
newer
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


  <span class="token comment" spellcheck="true">
// minify production code
</span>

  <span class="token keyword">
if
</span>
 <span class="token punctuation">
(
</span>
<span class="token operator">
!
</span>
devBuild<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

    page <span class="token operator">
=
</span>
 page<span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
htmlclean
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>

  <span class="token punctuation">
}
</span>


  <span class="token keyword">
return
</span>
 page<span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
gulp<span class="token punctuation">
.
</span>
<span class="token function">
dest
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>

<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
This reuses <code class=" language-undefined">
gulp-newer
</code>
 and introduces a couple of concepts:
</p>
<ol>
<li>
The <code class=" language-undefined">
[images]
</code>
 argument states that our <code class=" language-undefined">
images
</code>
 task must be run before processing the HTML (the HTML is likely to reference images). Any number of dependent tasks can be listed in this array and all will complete before the task function runs.
</li>
<li>
We only pipe the HTML through <code class=" language-undefined">
gulp-htmlclean
</code>
 if <code class=" language-undefined">
NODE_ENV
</code>
 is set to <code class=" language-undefined">
production
</code>
. Therefore, the HTML remains uncompressed during development which may be useful for debugging.
</li>

</ol>
<p>
Save <code class=" language-undefined">
gulpfile.js
</code>
 and run <code class=" language-undefined">
gulp html
</code>
 from the command line. Both the <code class=" language-undefined">
html
</code>
 and <code class=" language-undefined">
images
</code>
 tasks will run.
</p>
<h3 id="javascripttask">
JavaScript Task
</h3>
<p>
Too easy for you? Let’s process all our JavaScript files by building a basic module bundler. It will:
</p>
<ol>
<li>
ensure dependencies are loaded first using the <a href="https://www.npmjs.com/package/gulp-deporder">
gulp-deporder
</a>
 plug-in. This analyses comments at the top of each script to ensure correct ordering e.g. <code class=" language-undefined">
// needs: defaults.js lib.js
</code>
.
</li>
<li>
concatenate all script files into a single <code class=" language-undefined">
main.js
</code>
 file using <a href="https://www.npmjs.com/package/gulp-concat">
gulp-concat
</a>
, and
</li>
<li>
remove all <code class=" language-undefined">
console
</code>
 and <code class=" language-undefined">
debugging
</code>
 statements with <a href="https://www.npmjs.com/package/gulp-strip-debug">
gulp-strip-debug
</a>
 and minimize code with <a href="https://www.npmjs.com/package/gulp-uglify">
gulp-uglify
</a>
. This step will only occur when running in production mode.
</li>

</ol>
<p>
Install the plug-ins:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp-deporder gulp-concat gulp-strip-debug gulp-uglify --save-dev

</code>

</pre>
<p>
Reference them at the top of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token keyword">
var
</span>

  <span class="token punctuation">
.
</span>
<span class="token punctuation">
.
</span>
<span class="token punctuation">
.
</span>

  concat <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-concat'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  deporder <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-deporder'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  stripdebug <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-strip-debug'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  uglify <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-uglify'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


</code>

</pre>
<p>
Then add a new <code class=" language-undefined">
js
</code>
 task:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// JavaScript processing
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'js'
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>


  <span class="token keyword">
var
</span>
 jsbuild <span class="token operator">
=
</span>
 gulp<span class="token punctuation">
.
</span>
<span class="token function">
src
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'js/**/*'
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
deporder
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
concat
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'main.js'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


  <span class="token keyword">
if
</span>
 <span class="token punctuation">
(
</span>
<span class="token operator">
!
</span>
devBuild<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

    jsbuild <span class="token operator">
=
</span>
 jsbuild
      <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
stripdebug
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

      <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
uglify
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>

  <span class="token punctuation">
}
</span>


  <span class="token keyword">
return
</span>
 jsbuild<span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
gulp<span class="token punctuation">
.
</span>
<span class="token function">
dest
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
build <span class="token operator">
+
</span>
 <span class="token string">
'js/'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Save then run <code class=" language-undefined">
gulp js
</code>
 to watch the magic happen!
</p>
<h3 id="csstask">
CSS Task
</h3>
<p>
Finally, let’s create a CSS task which compiles Sass <code class=" language-undefined">
.scss
</code>
 files to a single <code class=" language-undefined">
.css
</code>
 file using <a href="https://www.npmjs.com/package/gulp-sass">
gulp-sass
</a>
. This is a Gulp plug-in for <a href="https://www.npmjs.com/package/node-sass">
node-sass
</a>
 which binds to the super-fast <a href="http://sass-lang.com/libsass">
LibSass C/C++ port of the Sass engine
</a>
 <em>
(you won’t need to install Ruby)
</em>
. We’ll presume your primary Sass file <code class=" language-undefined">
scss/main.scss
</code>
 is responsible for loading all partials.
</p>
<p>
Our task will also utilize the fabulous <a href="http://postcss.org/">
PostCSS
</a>
 via the <a href="https://github.com/postcss/gulp-postcss">
gulp-postcss
</a>
 plug-in. PostCSS needs its own set of plug-ins and we’ll install:
</p>
<ul>
<li>
<a href="https://www.npmjs.com/package/postcss-assets">
postcss-assets
</a>
 to manage assets. This allows us to use properties such as <code class=" language-undefined">
background: resolve('image.png');
</code>
 to resolve file paths or <code class=" language-undefined">
background: inline('image.png');
</code>
 to inline data-encoded images.
</li>
<li>
<a href="https://www.npmjs.com/package/autoprefixer">
autoprefixer
</a>
 to automatically add vendor prefixes to CSS properties.
</li>
<li>
<a href="https://www.npmjs.com/package/css-mqpacker">
css-mqpacker
</a>
 to pack multiple references to the same CSS media query into a single rule.
</li>
<li>
<a href="https://www.npmjs.com/package/cssnano">
cssnano
</a>
 to minify the CSS code when running in production mode.
</li>

</ul>
<p>
First, install all the modules:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
npm <span class="token function">
install
</span>
 gulp-sass gulp-postcss postcss-assets autoprefixer css-mqpacker cssnano --save-dev

</code>

</pre>
<p>
and reference them at the top of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token keyword">
var
</span>

  <span class="token punctuation">
.
</span>
<span class="token punctuation">
.
</span>
<span class="token punctuation">
.
</span>

  sass <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-sass'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  postcss <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-postcss'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  assets <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'postcss-assets'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  autoprefixer <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'autoprefixer'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  mqpacker <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'css-mqpacker'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  cssnano <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'cssnano'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>


</code>

</pre>
<p>
We can now create a new <code class=" language-undefined">
css
</code>
 task at the end of <code class=" language-undefined">
gulpfile.js
</code>
. Note the <code class=" language-undefined">
images
</code>
 task is set as a dependency because the <code class=" language-undefined">
postcss-assets
</code>
 plug-in can reference images during the build process. In addition, most plug-ins can be passed arguments – refer to their documentation for more information:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// CSS processing
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'css'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'images'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>


  <span class="token keyword">
var
</span>
 postCssOpts <span class="token operator">
=
</span>
 <span class="token punctuation">
[
</span>

  <span class="token function">
assets
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
{
</span>
 loadPaths<span class="token punctuation">
:
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'images/'
</span>
<span class="token punctuation">
]
</span>
 <span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  <span class="token function">
autoprefixer
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
{
</span>
 browsers<span class="token punctuation">
:
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'last 2 versions'
</span>
<span class="token punctuation">
,
</span>
 <span class="token string">
'&gt; 2%'
</span>
<span class="token punctuation">
]
</span>
 <span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
,
</span>

  mqpacker
  <span class="token punctuation">
]
</span>
<span class="token punctuation">
;
</span>


  <span class="token keyword">
if
</span>
 <span class="token punctuation">
(
</span>
<span class="token operator">
!
</span>
devBuild<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

    postCssOpts<span class="token punctuation">
.
</span>
<span class="token function">
push
</span>
<span class="token punctuation">
(
</span>
cssnano<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>

  <span class="token punctuation">
}
</span>


  <span class="token keyword">
return
</span>
 gulp<span class="token punctuation">
.
</span>
<span class="token function">
src
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'scss/main.scss'
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
sass
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
{
</span>

      outputStyle<span class="token punctuation">
:
</span>
 <span class="token string">
'nested'
</span>
<span class="token punctuation">
,
</span>

      imagePath<span class="token punctuation">
:
</span>
 <span class="token string">
'images/'
</span>
<span class="token punctuation">
,
</span>

      precision<span class="token punctuation">
:
</span>
 <span class="token number">
3
</span>
<span class="token punctuation">
,
</span>

      errLogToConsole<span class="token punctuation">
:
</span>
 <span class="token boolean">
true
</span>

    <span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
postcss
</span>
<span class="token punctuation">
(
</span>
postCssOpts<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
gulp<span class="token punctuation">
.
</span>
<span class="token function">
dest
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
build <span class="token operator">
+
</span>
 <span class="token string">
'css/'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Save the file and run the task from the command line:
</p>
<pre class=" language-bash">
<code class="bash language-bash">
gulp css

</code>

</pre>
<h2 id="step6automatetasks">
Step 6: Automate You Gulp Tasks
</h2>
<p>
We’ve been running one task at a time. We can run them all in one command by adding a new <code class=" language-undefined">
run
</code>
 task to <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// run all tasks
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'run'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'html'
</span>
<span class="token punctuation">
,
</span>
 <span class="token string">
'css'
</span>
<span class="token punctuation">
,
</span>
 <span class="token string">
'js'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Save and enter <code class=" language-undefined">
gulp run
</code>
 at the command line to execute all tasks. Note I omitted the <code class=" language-undefined">
images
</code>
 task because it’s already set as a dependency for the <code class=" language-undefined">
html
</code>
 and <code class=" language-undefined">
css
</code>
 tasks.
</p>
<p>
Is this still too much hard work? Gulp offers another method – <code class=" language-undefined">
gulp.watch
</code>
 – which can monitor your source files and run an appropriate task whenever a file is changed. The method is passed a folder and a list of tasks to execute when a change occurs. Let’s create a new <code class=" language-undefined">
watch
</code>
 task at the end of <code class=" language-undefined">
gulpfile.js
</code>
:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// watch for changes
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'watch'
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>


  <span class="token comment" spellcheck="true">
// image changes
</span>

  gulp<span class="token punctuation">
.
</span>
<span class="token function">
watch
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'images/**/*'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'images'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


  <span class="token comment" spellcheck="true">
// html changes
</span>

  gulp<span class="token punctuation">
.
</span>
<span class="token function">
watch
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'html/**/*'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'html'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


  <span class="token comment" spellcheck="true">
// javascript changes
</span>

  gulp<span class="token punctuation">
.
</span>
<span class="token function">
watch
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'js/**/*'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'js'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


  <span class="token comment" spellcheck="true">
// css changes
</span>

  gulp<span class="token punctuation">
.
</span>
<span class="token function">
watch
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'scss/**/*'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'css'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Rather than running <code class=" language-undefined">
gulp watch
</code>
 immediately, let’s add a default task:
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token comment" spellcheck="true">
// default task
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'default'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'run'
</span>
<span class="token punctuation">
,
</span>
 <span class="token string">
'watch'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Save <code class=" language-undefined">
gulpfile.js
</code>
 and enter <code class=" language-undefined">
gulp
</code>
 at the command line. Your images, HTML, CSS and JavaScript will all be processed then Gulp will remain active watching for updates and re-running tasks as necessary. Hit Ctrl/Cmd + C to abort monitoring and return to the command line.
</p>
<h2 id="step7profit">
Step 7: Yupi!
</h2>
<p>
Other plug-ins you may find useful:
</p>
<ul>
<li>
<a href="https://www.npmjs.com/package/gulp-load-plugins">
gulp-load-plugins
</a>
 – load all Gulp plug-in modules without <code class=" language-undefined">
require
</code>
 declarations
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-preprocess">
gulp-preprocess
</a>
 – a simple HTML and JavaScript <a href="https://github.com/jsoverson/preprocess">
preprocess
</a>
or
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-less">
gulp-less
</a>
 – the <a href="http://lesscss.org/">
Less CSS pre-processor
</a>
 plug-in
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-stylus">
gulp-stylus
</a>
 – the <a href="http://stylus-lang.com/">
Stylus CSS pre-processor
</a>
 plug-in
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-sequence">
gulp-sequence
</a>
 – run a series of gulp tasks in a specific order
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-plumber">
gulp-plumber
</a>
 – error handling which prevents Gulp stopping on failures
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-size">
gulp-size
</a>
 – displays file sizes and savings
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-nodemon">
gulp-nodemon
</a>
 – uses <a href="https://www.npmjs.com/package/nodemon">
nodemon
</a>
 to automatically rebegin Node.js applications when changes occur.
</li>
<li>
<a href="https://www.npmjs.com/package/gulp-util">
gulp-util
</a>
 – utility functions including logging and color-coding
</li>

</ul>
<p>
One useful method in <code class=" language-undefined">
gulp-util
</code>
 is <code class=" language-undefined">
.noop()
</code>
 which passes data straight through without performing any action. This could be used for cleaner development/production processing code, e.g.
</p>
<pre class=" language-javascript">
<code class="javascript language-javascript">
<span class="token keyword">
var
</span>
 gutil <span class="token operator">
=
</span>
 <span class="token function">
require
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'gulp-util'
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


<span class="token comment" spellcheck="true">
// HTML processing
</span>

gulp<span class="token punctuation">
.
</span>
<span class="token function">
task
</span>
<span class="token punctuation">
(
</span>
<span class="token string">
'html'
</span>
<span class="token punctuation">
,
</span>
 <span class="token punctuation">
[
</span>
<span class="token string">
'images'
</span>
<span class="token punctuation">
]
</span>
<span class="token punctuation">
,
</span>
 <span class="token keyword">
function
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
{
</span>

  <span class="token keyword">
var
</span>
 out <span class="token operator">
=
</span>
 folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'html/**/*'
</span>
<span class="token punctuation">
;
</span>


  <span class="token keyword">
return
</span>
 gulp<span class="token punctuation">
.
</span>
<span class="token function">
src
</span>
<span class="token punctuation">
(
</span>
folder<span class="token punctuation">
.
</span>
src <span class="token operator">
+
</span>
 <span class="token string">
'html/**/*'
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
<span class="token function">
newer
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
devBuild <span class="token operator">
?
</span>
 gutil<span class="token punctuation">
.
</span>
<span class="token function">
noop
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
 <span class="token punctuation">
:
</span>
 <span class="token function">
htmlclean
</span>
<span class="token punctuation">
(
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>

    <span class="token punctuation">
.
</span>
<span class="token function">
pipe
</span>
<span class="token punctuation">
(
</span>
gulp<span class="token punctuation">
.
</span>
<span class="token function">
dest
</span>
<span class="token punctuation">
(
</span>
out<span class="token punctuation">
)
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


<span class="token punctuation">
}
</span>
<span class="token punctuation">
)
</span>
<span class="token punctuation">
;
</span>


</code>

</pre>
<p>
Gulp can also call other Node.js modules – they don’t necessarily need to be plug-ins, e.g.
</p>
<ul>
<li>
<a href="https://www.npmjs.com/package/browser-sync">
browser-sync
</a>
 – automatically reload assets or refresh your browser when changes occur
</li>
<li>
<a href="https://www.npmjs.com/package/del">
del
</a>
 – delete files and folders (perhaps clean your <code class=" language-undefined">
build
</code>
 folder at the begin of every run).
</li>

</ul>
<p>
Invest a little time and Gulp could save many hours of development frustration. The advantages:
</p>
<ul>
<li>
<a href="https://npmjs.org/browse/keyword/gulpplugin/">
plug-ins are plentiful
</a>

</li>
<li>
configuration using pipes is readable and easy to follow
</li>
<li>
<code class=" language-undefined">
gulpfile.js
</code>
 can be adapted and reused in other projects
</li>
<li>
your total page weight can be reduced to improve performance
</li>
<li>
you can simplify your deployment.
</li>

</ul>
<p>
Useful links:
</p>
<ul>
<li>
<a href="http://gulpjs.com/">
Gulp home page
</a>

</li>
<li>
<a href="https://npmjs.org/browse/keyword/gulpplugin/">
Gulp plug-ins
</a>

</li>
<li>
<a href="https://www.npmjs.com/">
npm home page
</a>

</li>

</ul>

</div>

</div>

</div>

</div>

</div>

</div>
<div class="sidebar">
<div class="widget widget_categories">
<h6>
Categories
</h6>
<ul>
<li class="cat-item cat-item-43">
<a href="https://jacekjeznach.com/category/htmlcss/" >
HTML/CSS
</a>

</li>
<li class="cat-item cat-item-1">
<a href="https://jacekjeznach.com/category/other/" >
Other
</a>

</li>
<li class="cat-item cat-item-48">
<a href="https://jacekjeznach.com/category/personal/" >
Personal
</a>

</li>
<li class="cat-item cat-item-9">
<a href="https://jacekjeznach.com/category/tools/" >
Tools
</a>

</li>
<li class="cat-item cat-item-45">
<a href="https://jacekjeznach.com/category/tutorials/" >
Tutorials
</a>

</li>
<li class="cat-item cat-item-44">
<a href="https://jacekjeznach.com/category/wordpress/" >
WordPress
</a>

</li>

</ul>

</div>
<div class="widget widget_tag_cloud">
<h6>
Tags
</h6>
<div class="tagcloud">
<a href='https://jacekjeznach.com/tag/animation/' class='tag-link-37' title='8 topics' style='font-size: 18.705882352941pt;'>
animation
</a>
 <a href='https://jacekjeznach.com/tag/bootstrap/' class='tag-link-35' title='1 topic' style='font-size: 8pt;'>
bootstrap
</a>
 <a href='https://jacekjeznach.com/tag/css/' class='tag-link-46' title='2 topics' style='font-size: 10.964705882353pt;'>
css
</a>
 <a href='https://jacekjeznach.com/tag/education/' class='tag-link-25' title='2 topics' style='font-size: 10.964705882353pt;'>
edu
</a>
 <a href='https://jacekjeznach.com/tag/fonts/' class='tag-link-17' title='8 topics' style='font-size: 18.705882352941pt;'>
fonts
</a>
 <a href='https://jacekjeznach.com/tag/form/' class='tag-link-32' title='1 topic' style='font-size: 8pt;'>
form
</a>
 <a href='https://jacekjeznach.com/tag/framework/' class='tag-link-11' title='7 topics' style='font-size: 17.882352941176pt;'>
framework
</a>
 <a href='https://jacekjeznach.com/tag/front-end/' class='tag-link-49' title='1 topic' style='font-size: 8pt;'>
front-end
</a>
 <a href='https://jacekjeznach.com/tag/grid/' class='tag-link-6' title='1 topic' style='font-size: 8pt;'>
grid
</a>
 <a href='https://jacekjeznach.com/tag/images/' class='tag-link-30' title='5 topics' style='font-size: 15.905882352941pt;'>
images
</a>
 <a href='https://jacekjeznach.com/tag/jquery-plugins/' class='tag-link-7' title='13 topics' style='font-size: 22pt;'>
jquery plugins
</a>
 <a href='https://jacekjeznach.com/tag/less/' class='tag-link-51' title='1 topic' style='font-size: 8pt;'>
less
</a>
 <a href='https://jacekjeznach.com/tag/mobile-2/' class='tag-link-23' title='6 topics' style='font-size: 17.058823529412pt;'>
mobile
</a>
 <a href='https://jacekjeznach.com/tag/mvc/' class='tag-link-28' title='4 topics' style='font-size: 14.588235294118pt;'>
mvc
</a>
 <a href='https://jacekjeznach.com/tag/newsletter-2/' class='tag-link-20' title='3 topics' style='font-size: 12.941176470588pt;'>
newsletter
</a>
 <a href='https://jacekjeznach.com/tag/online-tool/' class='tag-link-14' title='10 topics' style='font-size: 20.188235294118pt;'>
online tool
</a>
 <a href='https://jacekjeznach.com/tag/parallax/' class='tag-link-38' title='1 topic' style='font-size: 8pt;'>
parallax
</a>
 <a href='https://jacekjeznach.com/tag/performance/' class='tag-link-26' title='6 topics' style='font-size: 17.058823529412pt;'>
performance
</a>
 <a href='https://jacekjeznach.com/tag/polyfil/' class='tag-link-31' title='1 topic' style='font-size: 8pt;'>
polyfil
</a>
 <a href='https://jacekjeznach.com/tag/rwd-2/' class='tag-link-12' title='7 topics' style='font-size: 17.882352941176pt;'>
rwd
</a>
 <a href='https://jacekjeznach.com/tag/sass/' class='tag-link-29' title='4 topics' style='font-size: 14.588235294118pt;'>
SASS
</a>
 <a href='https://jacekjeznach.com/tag/scroll/' class='tag-link-39' title='1 topic' style='font-size: 8pt;'>
scroll
</a>
 <a href='https://jacekjeznach.com/tag/security/' class='tag-link-47' title='1 topic' style='font-size: 8pt;'>
security
</a>
 <a href='https://jacekjeznach.com/tag/select/' class='tag-link-21' title='3 topics' style='font-size: 12.941176470588pt;'>
select
</a>
 <a href='https://jacekjeznach.com/tag/seo/' class='tag-link-22' title='1 topic' style='font-size: 8pt;'>
seo
</a>
 <a href='https://jacekjeznach.com/tag/slider/' class='tag-link-42' title='1 topic' style='font-size: 8pt;'>
slider
</a>
 <a href='https://jacekjeznach.com/tag/starter/' class='tag-link-33' title='1 topic' style='font-size: 8pt;'>
starter
</a>
 <a href='https://jacekjeznach.com/tag/task-runner/' class='tag-link-50' title='1 topic' style='font-size: 8pt;'>
task runner
</a>
 <a href='https://jacekjeznach.com/tag/test/' class='tag-link-15' title='10 topics' style='font-size: 20.188235294118pt;'>
test
</a>
 <a href='https://jacekjeznach.com/tag/twitter/' class='tag-link-36' title='1 topic' style='font-size: 8pt;'>
twitter
</a>
 <a href='https://jacekjeznach.com/tag/typography/' class='tag-link-40' title='3 topics' style='font-size: 12.941176470588pt;'>
typography
</a>
 <a href='https://jacekjeznach.com/tag/video/' class='tag-link-24' title='1 topic' style='font-size: 8pt;'>
video
</a>
 <a href='https://jacekjeznach.com/tag/wordpress-2/' class='tag-link-19' title='9 topics' style='font-size: 19.529411764706pt;'>
wordpress
</a>
 <a href='https://jacekjeznach.com/tag/wp-plugin/' class='tag-link-41' title='1 topic' style='font-size: 8pt;'>
wp plugin
</a>

</div>

</div>

</div>
<div style="clear: both">

</div>

</div>

</div>
 <script type='text/javascript' src='wp-includes/js/wp-embed.min.js?ver=5600043c36802d51cde71399f3d25aeb'>

</script>
 <a class="blog-link white" href="https://jacekjeznach.com/">
 <img src="wp-content/themes/jj/img/blogwhite.png" alt="web developer blog, wordpress developer blog" />
 <span class="folded-corner">

</span>

</a>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js">

</script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js">

</script>
 <script src="wp-content/themes/jj/js/plugins.js">

</script>
 <script src="wp-content/themes/jj/js/vendor/jquery.waypoints.js">

</script>
 <script src="wp-content/themes/jj/js/wall.js">

</script>

</body>

</html>
